"use strict";if(!Cabana)var Cabana={};Cabana.vars||(Cabana.vars={}),Cabana.vars.FacebookScraper={errors:[]},Cabana.FacebookScraper=function(){var _this=Cabana.FacebookScraper;var config=arguments.length>0?arguments[0]:arguments,configOptions;if(config&&config.options&&(configOptions=config.options),0==arguments.length){var ajax=function(config,callback){var request=new XMLHttpRequest;if(config)if(request.open(config.method,encodeURI(config.url)),request.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),request.onreadystatechange=function(){if(4==request.readyState&&200==request.status){var result=JSON.parse(request.responseText);result&&callback?callback(result):config.callback&&config.scrapeArguments&&config.callback(config.scrapeArguments[0],config.scrapeArguments[1])}},config.data){var formData=[];for(var key in config.data)formData.push(key+"="+config.data[key]);request.send(formData.join("&"))}else request.send()};var listeners=function(){document.querySelector("[data-scrape]").addEventListener("click",function(){var url=document.querySelector("[data-scrape-url]").value;if(url){var urlParse=function(href){var l=document.createElement("a");return l.href=href,l};Cabana.vars.FacebookScraper.baseUrl=urlParse(url).protocol+urlParse(url).host,Cabana.FacebookScraper().ajax({url:location.href+"?parse="+url,method:"GET"},Cabana.FacebookScraper().scrape)}})};var scrape=function(object,progress){var status=document.querySelector("[data-scrape-status]");if(object&&object.url){Cabana.vars.FacebookScraper.urls=object.url;var statusLength=Object.keys(object.url).length;return status.innerHTML="Found "+statusLength+" URLs<br />",void _this().scrape(object.url[0],0)}if(!progress)var progress=0;var toScrape=[];if(Cabana.vars.FacebookScraper.urls[progress]&&2>progress){var host=Cabana.vars.FacebookScraper.baseUrl?Cabana.vars.FacebookScraper.baseUrl:location.href;var url=-1==object.loc.indexOf("http://")&&-1==object.loc.indexOf("https://")?host+object.loc:object.loc;_this().ajax({url:_this().scrapeUrl,method:"POST",data:{id:url,scrape:!0},callback:Cabana.FacebookScraper().scrape,scrapeArguments:[Cabana.vars.FacebookScraper.urls[progress+1],progress+1]})}};return function(){return{ajax:ajax,listeners:listeners,scrape:scrape,scrapeUrl:"https://graph.facebook.com"}}()}var returnState=!1;try{this[this.type.toLowerCase()](this.url),returnState=!0}catch(e){Cabana.vars.FacebookScraper.errors.push(e),returnState=!1}finally{return returnState}},Cabana.FacebookScraper().listeners();